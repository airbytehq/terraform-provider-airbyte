# Contributing to This Repository

Thank you for your interest in contributing to this repository. Please note that this repository contains generated code. As such, we do not accept direct changes or pull requests that modify generated code. Instead, we encourage you to follow the guidelines below to report issues and suggest improvements.

## Important: This is a Generated Codebase

The entire provider is automatically generated by the [Speakeasy CLI](https://www.speakeasy.com/) from Airbyte's OpenAPI specification. Direct code modifications to generated files are not accepted; changes must be made to the upstream OpenAPI spec in [airbyte-platform](https://github.com/airbytehq/airbyte-platform), which triggers regeneration.

## How to Report Issues

If you encounter any bugs or have suggestions for improvements, please open an issue on GitHub. When reporting an issue, please provide as much detail as possible to help us reproduce the problem. This includes:

- A clear and descriptive title
- Steps to reproduce the issue
- Expected and actual behavior
- Any relevant logs, screenshots, or error messages
- Information about your environment (e.g., operating system, Terraform version, provider version)

## Issue Triage and Upstream Fixes

We will review and triage issues as quickly as possible. Our goal is to address bugs and incorporate improvements in the upstream source code. Fixes will be included in the next generation of the generated code.

---

## For Maintainers: Build, Test, and Publish

This section is for Airbyte maintainers who need to build, test, and publish updates to the provider.

### Prerequisites

- Go 1.21+ (check `go.mod` for exact version)
- Terraform 1.0+
- [Speakeasy CLI](https://www.speakeasy.com/docs/speakeasy-cli/getting-started) (for regeneration)
- GPG key (for releases)

### Building the Provider

```bash
# Build the provider binary
go build -o terraform-provider-airbyte

# Run linting
golangci-lint run --timeout 5m

# Generate documentation
go generate ./...
```

### Testing the Provider Locally

#### Option 1: Debug Mode (recommended for development)

This allows you to attach debuggers (e.g., delve) to the provider:

```bash
go run main.go --debug
# Copy the TF_REATTACH_PROVIDERS env var from the output

# In a new terminal, navigate to an example directory
cd examples/your-example
export TF_REATTACH_PROVIDERS='...'  # paste the value from above
terraform init
terraform apply
```

#### Option 2: Local Binary with dev_overrides

1. Build the provider: `go build -o terraform-provider-airbyte`
2. Add to your `~/.terraformrc`:

```hcl
provider_installation {
  dev_overrides {
    "registry.terraform.io/airbytehq/airbyte" = "/path/to/terraform-provider-airbyte"
  }
  direct {}
}
```

3. Run Terraform commands (skip `terraform init` when using dev_overrides)

#### Running Acceptance Tests

```bash
# Run all acceptance tests (requires Airbyte instance)
TF_ACC=1 go test -v -cover ./internal/provider/
```

### Regenerating the Provider

The provider is regenerated from Airbyte's OpenAPI specification using Speakeasy.

#### Manual Regeneration

```bash
# Install Speakeasy CLI if not already installed
# See: https://www.speakeasy.com/docs/speakeasy-cli/getting-started

# Run regeneration
make all
# Or directly:
speakeasy run
```

#### Automated Regeneration via GitHub Actions

The `speakeasy_sdk_generation.yml` workflow can be triggered manually:

1. Go to Actions > Generate > Run workflow
2. Optionally check "Force generation of SDKs"
3. This creates a PR with the regenerated code for review

### Publishing a New Release

Releases are automated via GitHub Actions when a new tag is pushed.

#### Release Process

1. **Ensure all changes are merged to main**
   - Verify CI passes on main branch
   - Review any pending regeneration PRs

2. **Update version in gen.yaml** (if needed)
   - The `terraform.version` field in `gen.yaml` tracks the provider version

3. **Create and push a new tag**
   ```bash
   git checkout main
   git pull origin main
   git tag v0.X.Y
   git push origin v0.X.Y
   ```

4. **Monitor the release workflow**
   - The `release.yml` workflow will automatically:
     - Build binaries for multiple platforms (darwin, linux, windows Ã— amd64, arm64)
     - Sign artifacts with GPG
     - Publish to the [Terraform Registry](https://registry.terraform.io/providers/airbytehq/airbyte)

5. **Verify the release**
   - Check the [Terraform Registry](https://registry.terraform.io/providers/airbytehq/airbyte/latest) for the new version
   - Test installation: `terraform init` with the new version

### Configuration Files

| File | Purpose |
|------|---------|
| `.speakeasy/workflow.yaml` | Speakeasy generation configuration |
| `.speakeasy/gen.lock` | Lock file tracking generation state |
| `gen.yaml` | Provider-specific generation settings |
| `.goreleaser.yml` | Multi-platform build and release configuration |

### Connector Modules

As of v0.13.0, individual source and destination connector resources are being moved to separate Terraform modules. These modules are available at:

- **Documentation**: https://airbytehq.github.io/airbyte-terraform-modules/
- **Downloads**: Available via the documentation site

Users should migrate from using `airbyte_source_*` and `airbyte_destination_*` resources to the new module-based approach for connector-specific configurations.

---

## Contact

If you have any questions or need further assistance, please feel free to reach out by opening an issue.

Thank you for your understanding and cooperation!

The Maintainers
