// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package shared

import (
	"encoding/json"
	"errors"
	"fmt"
	"github.com/airbytehq/terraform-provider-airbyte/internal/sdk/internal/utils"
	"github.com/airbytehq/terraform-provider-airbyte/internal/sdk/types"
	"time"
)

// SourceTrustpilotUpdateAPIKey - The API key authentication method gives you access to only the streams which are part of the Public API. When you want to get streams available via the Consumer API (e.g. the private reviews) you need to use authentication method OAuth 2.0.
type SourceTrustpilotUpdateAPIKey struct {
	authType *string `const:"apikey" json:"auth_type,omitempty"`
	// The API key of the Trustpilot API application.
	ClientID *string `json:"client_id,omitempty"`
}

func (s SourceTrustpilotUpdateAPIKey) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(s, "", false)
}

func (s *SourceTrustpilotUpdateAPIKey) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &s, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (s *SourceTrustpilotUpdateAPIKey) GetAuthType() *string {
	return types.Pointer("apikey")
}

func (s *SourceTrustpilotUpdateAPIKey) GetClientID() *string {
	if s == nil {
		return nil
	}
	return s.ClientID
}

type SourceTrustpilotUpdateOAuth20 struct {
	// Access Token for making authenticated requests.
	AccessToken *string `json:"access_token,omitempty"`
	authType    *string `const:"oauth2.0" json:"auth_type,omitempty"`
	// The API key of the Trustpilot API application. (represents the OAuth Client ID)
	ClientID *string `json:"client_id,omitempty"`
	// The Secret of the Trustpilot API application. (represents the OAuth Client Secret)
	ClientSecret *string `json:"client_secret,omitempty"`
	// The key to refresh the expired access_token.
	RefreshToken *string `json:"refresh_token,omitempty"`
	// The date-time when the access token should be refreshed.
	TokenExpiryDate *time.Time `json:"token_expiry_date,omitempty"`
}

func (s SourceTrustpilotUpdateOAuth20) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(s, "", false)
}

func (s *SourceTrustpilotUpdateOAuth20) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &s, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (s *SourceTrustpilotUpdateOAuth20) GetAccessToken() *string {
	if s == nil {
		return nil
	}
	return s.AccessToken
}

func (s *SourceTrustpilotUpdateOAuth20) GetAuthType() *string {
	return types.Pointer("oauth2.0")
}

func (s *SourceTrustpilotUpdateOAuth20) GetClientID() *string {
	if s == nil {
		return nil
	}
	return s.ClientID
}

func (s *SourceTrustpilotUpdateOAuth20) GetClientSecret() *string {
	if s == nil {
		return nil
	}
	return s.ClientSecret
}

func (s *SourceTrustpilotUpdateOAuth20) GetRefreshToken() *string {
	if s == nil {
		return nil
	}
	return s.RefreshToken
}

func (s *SourceTrustpilotUpdateOAuth20) GetTokenExpiryDate() *time.Time {
	if s == nil {
		return nil
	}
	return s.TokenExpiryDate
}

type SourceTrustpilotUpdateAuthorizationMethodType string

const (
	SourceTrustpilotUpdateAuthorizationMethodTypeSourceTrustpilotUpdateOAuth20 SourceTrustpilotUpdateAuthorizationMethodType = "source-trustpilot-update_OAuth 2.0"
	SourceTrustpilotUpdateAuthorizationMethodTypeSourceTrustpilotUpdateAPIKey  SourceTrustpilotUpdateAuthorizationMethodType = "source-trustpilot-update_API Key"
)

type SourceTrustpilotUpdateAuthorizationMethod struct {
	SourceTrustpilotUpdateOAuth20 *SourceTrustpilotUpdateOAuth20 `queryParam:"inline" union:"member"`
	SourceTrustpilotUpdateAPIKey  *SourceTrustpilotUpdateAPIKey  `queryParam:"inline" union:"member"`

	Type SourceTrustpilotUpdateAuthorizationMethodType
}

func CreateSourceTrustpilotUpdateAuthorizationMethodSourceTrustpilotUpdateOAuth20(sourceTrustpilotUpdateOAuth20 SourceTrustpilotUpdateOAuth20) SourceTrustpilotUpdateAuthorizationMethod {
	typ := SourceTrustpilotUpdateAuthorizationMethodTypeSourceTrustpilotUpdateOAuth20

	return SourceTrustpilotUpdateAuthorizationMethod{
		SourceTrustpilotUpdateOAuth20: &sourceTrustpilotUpdateOAuth20,
		Type:                          typ,
	}
}

func CreateSourceTrustpilotUpdateAuthorizationMethodSourceTrustpilotUpdateAPIKey(sourceTrustpilotUpdateAPIKey SourceTrustpilotUpdateAPIKey) SourceTrustpilotUpdateAuthorizationMethod {
	typ := SourceTrustpilotUpdateAuthorizationMethodTypeSourceTrustpilotUpdateAPIKey

	return SourceTrustpilotUpdateAuthorizationMethod{
		SourceTrustpilotUpdateAPIKey: &sourceTrustpilotUpdateAPIKey,
		Type:                         typ,
	}
}

func (u *SourceTrustpilotUpdateAuthorizationMethod) UnmarshalJSON(data []byte) error {

	var candidates []utils.UnionCandidate

	// Collect all valid candidates
	var sourceTrustpilotUpdateOAuth20 SourceTrustpilotUpdateOAuth20 = SourceTrustpilotUpdateOAuth20{}
	if err := utils.UnmarshalJSON(data, &sourceTrustpilotUpdateOAuth20, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  SourceTrustpilotUpdateAuthorizationMethodTypeSourceTrustpilotUpdateOAuth20,
			Value: &sourceTrustpilotUpdateOAuth20,
		})
	}

	var sourceTrustpilotUpdateAPIKey SourceTrustpilotUpdateAPIKey = SourceTrustpilotUpdateAPIKey{}
	if err := utils.UnmarshalJSON(data, &sourceTrustpilotUpdateAPIKey, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  SourceTrustpilotUpdateAuthorizationMethodTypeSourceTrustpilotUpdateAPIKey,
			Value: &sourceTrustpilotUpdateAPIKey,
		})
	}

	if len(candidates) == 0 {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SourceTrustpilotUpdateAuthorizationMethod", string(data))
	}

	// Pick the best candidate using multi-stage filtering
	best := utils.PickBestUnionCandidate(candidates, data)
	if best == nil {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SourceTrustpilotUpdateAuthorizationMethod", string(data))
	}

	// Set the union type and value based on the best candidate
	u.Type = best.Type.(SourceTrustpilotUpdateAuthorizationMethodType)
	switch best.Type {
	case SourceTrustpilotUpdateAuthorizationMethodTypeSourceTrustpilotUpdateOAuth20:
		u.SourceTrustpilotUpdateOAuth20 = best.Value.(*SourceTrustpilotUpdateOAuth20)
		return nil
	case SourceTrustpilotUpdateAuthorizationMethodTypeSourceTrustpilotUpdateAPIKey:
		u.SourceTrustpilotUpdateAPIKey = best.Value.(*SourceTrustpilotUpdateAPIKey)
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for SourceTrustpilotUpdateAuthorizationMethod", string(data))
}

func (u SourceTrustpilotUpdateAuthorizationMethod) MarshalJSON() ([]byte, error) {
	if u.SourceTrustpilotUpdateOAuth20 != nil {
		return utils.MarshalJSON(u.SourceTrustpilotUpdateOAuth20, "", true)
	}

	if u.SourceTrustpilotUpdateAPIKey != nil {
		return utils.MarshalJSON(u.SourceTrustpilotUpdateAPIKey, "", true)
	}

	return nil, errors.New("could not marshal union type SourceTrustpilotUpdateAuthorizationMethod: all fields are null")
}

type SourceTrustpilotUpdateSourceType string

const (
	SourceTrustpilotUpdateSourceTypeTrustpilot SourceTrustpilotUpdateSourceType = "trustpilot"
)

func (e SourceTrustpilotUpdateSourceType) ToPointer() *SourceTrustpilotUpdateSourceType {
	return &e
}
func (e *SourceTrustpilotUpdateSourceType) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "trustpilot":
		*e = SourceTrustpilotUpdateSourceType(v)
		return nil
	default:
		return fmt.Errorf("invalid value for SourceTrustpilotUpdateSourceType: %v", v)
	}
}

type SourceTrustpilotUpdate struct {
	// The names of business units which shall be synchronized. Some streams e.g. configured_business_units or private_reviews use this configuration.
	BusinessUnits []string                                   `json:"business_units,omitempty"`
	Credentials   *SourceTrustpilotUpdateAuthorizationMethod `json:"credentials,omitempty"`
	// For streams with sync. method incremental the start date time to be used
	StartDate            *string                           `json:"start_date,omitempty"`
	sourceType           *SourceTrustpilotUpdateSourceType `const:"trustpilot" json:"sourceType"`
	AdditionalProperties any                               `additionalProperties:"true" json:"-"`
}

func (s SourceTrustpilotUpdate) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(s, "", false)
}

func (s *SourceTrustpilotUpdate) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &s, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (s *SourceTrustpilotUpdate) GetBusinessUnits() []string {
	if s == nil {
		return nil
	}
	return s.BusinessUnits
}

func (s *SourceTrustpilotUpdate) GetCredentials() *SourceTrustpilotUpdateAuthorizationMethod {
	if s == nil {
		return nil
	}
	return s.Credentials
}

func (s *SourceTrustpilotUpdate) GetStartDate() *string {
	if s == nil {
		return nil
	}
	return s.StartDate
}

func (s *SourceTrustpilotUpdate) GetSourceType() *SourceTrustpilotUpdateSourceType {
	return SourceTrustpilotUpdateSourceTypeTrustpilot.ToPointer()
}

func (s *SourceTrustpilotUpdate) GetAdditionalProperties() any {
	if s == nil {
		return nil
	}
	return s.AdditionalProperties
}
