// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package shared

import (
	"encoding/json"
	"errors"
	"fmt"
	"github.com/airbytehq/terraform-provider-airbyte/internal/sdk/internal/utils"
	"github.com/airbytehq/terraform-provider-airbyte/internal/sdk/types"
)

type AuthMethod string

const (
	AuthMethodOauth20 AuthMethod = "oauth2.0"
)

func (e AuthMethod) ToPointer() *AuthMethod {
	return &e
}
func (e *AuthMethod) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "oauth2.0":
		*e = AuthMethod(v)
		return nil
	default:
		return fmt.Errorf("invalid value for AuthMethod: %v", v)
	}
}

type GoogleOAuth20 struct {
	authMethod   *AuthMethod `const:"oauth2.0" json:"auth_method"`
	ClientID     string      `json:"client_id"`
	ClientSecret string      `json:"client_secret"`
	RefreshToken string      `json:"refresh_token"`
}

func (g GoogleOAuth20) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(g, "", false)
}

func (g *GoogleOAuth20) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &g, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (g *GoogleOAuth20) GetAuthMethod() *AuthMethod {
	return AuthMethodOauth20.ToPointer()
}

func (g *GoogleOAuth20) GetClientID() string {
	if g == nil {
		return ""
	}
	return g.ClientID
}

func (g *GoogleOAuth20) GetClientSecret() string {
	if g == nil {
		return ""
	}
	return g.ClientSecret
}

func (g *GoogleOAuth20) GetRefreshToken() string {
	if g == nil {
		return ""
	}
	return g.RefreshToken
}

type SourceYoutubeDataAPIKey struct {
	APIKey     string  `json:"api_key"`
	authMethod *string `const:"api_key" json:"auth_method,omitempty"`
}

func (s SourceYoutubeDataAPIKey) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(s, "", false)
}

func (s *SourceYoutubeDataAPIKey) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &s, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (s *SourceYoutubeDataAPIKey) GetAPIKey() string {
	if s == nil {
		return ""
	}
	return s.APIKey
}

func (s *SourceYoutubeDataAPIKey) GetAuthMethod() *string {
	return types.Pointer("api_key")
}

type SourceYoutubeDataAuthenticationMethodType string

const (
	SourceYoutubeDataAuthenticationMethodTypeSourceYoutubeDataAPIKey SourceYoutubeDataAuthenticationMethodType = "source-youtube-data_API Key"
	SourceYoutubeDataAuthenticationMethodTypeGoogleOAuth20           SourceYoutubeDataAuthenticationMethodType = "Google OAuth 2.0"
)

// SourceYoutubeDataAuthenticationMethod - Authentication method
type SourceYoutubeDataAuthenticationMethod struct {
	SourceYoutubeDataAPIKey *SourceYoutubeDataAPIKey `queryParam:"inline" union:"member"`
	GoogleOAuth20           *GoogleOAuth20           `queryParam:"inline" union:"member"`

	Type SourceYoutubeDataAuthenticationMethodType
}

func CreateSourceYoutubeDataAuthenticationMethodSourceYoutubeDataAPIKey(sourceYoutubeDataAPIKey SourceYoutubeDataAPIKey) SourceYoutubeDataAuthenticationMethod {
	typ := SourceYoutubeDataAuthenticationMethodTypeSourceYoutubeDataAPIKey

	return SourceYoutubeDataAuthenticationMethod{
		SourceYoutubeDataAPIKey: &sourceYoutubeDataAPIKey,
		Type:                    typ,
	}
}

func CreateSourceYoutubeDataAuthenticationMethodGoogleOAuth20(googleOAuth20 GoogleOAuth20) SourceYoutubeDataAuthenticationMethod {
	typ := SourceYoutubeDataAuthenticationMethodTypeGoogleOAuth20

	return SourceYoutubeDataAuthenticationMethod{
		GoogleOAuth20: &googleOAuth20,
		Type:          typ,
	}
}

func (u *SourceYoutubeDataAuthenticationMethod) UnmarshalJSON(data []byte) error {

	var candidates []utils.UnionCandidate

	// Collect all valid candidates
	var sourceYoutubeDataAPIKey SourceYoutubeDataAPIKey = SourceYoutubeDataAPIKey{}
	if err := utils.UnmarshalJSON(data, &sourceYoutubeDataAPIKey, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  SourceYoutubeDataAuthenticationMethodTypeSourceYoutubeDataAPIKey,
			Value: &sourceYoutubeDataAPIKey,
		})
	}

	var googleOAuth20 GoogleOAuth20 = GoogleOAuth20{}
	if err := utils.UnmarshalJSON(data, &googleOAuth20, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  SourceYoutubeDataAuthenticationMethodTypeGoogleOAuth20,
			Value: &googleOAuth20,
		})
	}

	if len(candidates) == 0 {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SourceYoutubeDataAuthenticationMethod", string(data))
	}

	// Pick the best candidate using multi-stage filtering
	best := utils.PickBestUnionCandidate(candidates, data)
	if best == nil {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SourceYoutubeDataAuthenticationMethod", string(data))
	}

	// Set the union type and value based on the best candidate
	u.Type = best.Type.(SourceYoutubeDataAuthenticationMethodType)
	switch best.Type {
	case SourceYoutubeDataAuthenticationMethodTypeSourceYoutubeDataAPIKey:
		u.SourceYoutubeDataAPIKey = best.Value.(*SourceYoutubeDataAPIKey)
		return nil
	case SourceYoutubeDataAuthenticationMethodTypeGoogleOAuth20:
		u.GoogleOAuth20 = best.Value.(*GoogleOAuth20)
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for SourceYoutubeDataAuthenticationMethod", string(data))
}

func (u SourceYoutubeDataAuthenticationMethod) MarshalJSON() ([]byte, error) {
	if u.SourceYoutubeDataAPIKey != nil {
		return utils.MarshalJSON(u.SourceYoutubeDataAPIKey, "", true)
	}

	if u.GoogleOAuth20 != nil {
		return utils.MarshalJSON(u.GoogleOAuth20, "", true)
	}

	return nil, errors.New("could not marshal union type SourceYoutubeDataAuthenticationMethod: all fields are null")
}

type SourceYoutubeDataSourceType string

const (
	SourceYoutubeDataSourceTypeYoutubeData SourceYoutubeDataSourceType = "youtube-data"
)

func (e SourceYoutubeDataSourceType) ToPointer() *SourceYoutubeDataSourceType {
	return &e
}
func (e *SourceYoutubeDataSourceType) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "youtube-data":
		*e = SourceYoutubeDataSourceType(v)
		return nil
	default:
		return fmt.Errorf("invalid value for SourceYoutubeDataSourceType: %v", v)
	}
}

type SourceYoutubeData struct {
	ChannelIds []any `json:"channel_ids"`
	// Authentication method
	Credentials          SourceYoutubeDataAuthenticationMethod `json:"credentials"`
	sourceType           *SourceYoutubeDataSourceType          `const:"youtube-data" json:"sourceType"`
	AdditionalProperties any                                   `additionalProperties:"true" json:"-"`
}

func (s SourceYoutubeData) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(s, "", false)
}

func (s *SourceYoutubeData) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &s, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (s *SourceYoutubeData) GetChannelIds() []any {
	if s == nil {
		return []any{}
	}
	return s.ChannelIds
}

func (s *SourceYoutubeData) GetCredentials() SourceYoutubeDataAuthenticationMethod {
	if s == nil {
		return SourceYoutubeDataAuthenticationMethod{}
	}
	return s.Credentials
}

func (s *SourceYoutubeData) GetSourceType() *SourceYoutubeDataSourceType {
	return SourceYoutubeDataSourceTypeYoutubeData.ToPointer()
}

func (s *SourceYoutubeData) GetAdditionalProperties() any {
	if s == nil {
		return nil
	}
	return s.AdditionalProperties
}
