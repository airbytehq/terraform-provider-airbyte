// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package shared

import (
	"encoding/json"
	"errors"
	"fmt"
	"github.com/airbytehq/terraform-provider-airbyte/internal/sdk/internal/utils"
	"github.com/airbytehq/terraform-provider-airbyte/internal/sdk/types"
	"time"
)

type SourceTypeformPrivateToken struct {
	// Log into your Typeform account and then generate a personal Access Token.
	AccessToken string  `json:"access_token"`
	authType    *string `const:"access_token" json:"auth_type,omitempty"`
}

func (s SourceTypeformPrivateToken) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(s, "", false)
}

func (s *SourceTypeformPrivateToken) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &s, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (s *SourceTypeformPrivateToken) GetAccessToken() string {
	if s == nil {
		return ""
	}
	return s.AccessToken
}

func (s *SourceTypeformPrivateToken) GetAuthType() *string {
	return types.Pointer("access_token")
}

type SourceTypeformOAuth20 struct {
	// Access Token for making authenticated requests.
	AccessToken string  `json:"access_token"`
	authType    *string `const:"oauth2.0" json:"auth_type,omitempty"`
	// The Client ID of the Typeform developer application.
	ClientID string `json:"client_id"`
	// The Client Secret the Typeform developer application.
	ClientSecret string `json:"client_secret"`
	// The key to refresh the expired access_token.
	RefreshToken string `json:"refresh_token"`
	// The date-time when the access token should be refreshed.
	TokenExpiryDate time.Time `json:"token_expiry_date"`
}

func (s SourceTypeformOAuth20) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(s, "", false)
}

func (s *SourceTypeformOAuth20) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &s, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (s *SourceTypeformOAuth20) GetAccessToken() string {
	if s == nil {
		return ""
	}
	return s.AccessToken
}

func (s *SourceTypeformOAuth20) GetAuthType() *string {
	return types.Pointer("oauth2.0")
}

func (s *SourceTypeformOAuth20) GetClientID() string {
	if s == nil {
		return ""
	}
	return s.ClientID
}

func (s *SourceTypeformOAuth20) GetClientSecret() string {
	if s == nil {
		return ""
	}
	return s.ClientSecret
}

func (s *SourceTypeformOAuth20) GetRefreshToken() string {
	if s == nil {
		return ""
	}
	return s.RefreshToken
}

func (s *SourceTypeformOAuth20) GetTokenExpiryDate() time.Time {
	if s == nil {
		return time.Time{}
	}
	return s.TokenExpiryDate
}

type SourceTypeformAuthorizationMethodType string

const (
	SourceTypeformAuthorizationMethodTypeSourceTypeformOAuth20      SourceTypeformAuthorizationMethodType = "source-typeform_OAuth2.0"
	SourceTypeformAuthorizationMethodTypeSourceTypeformPrivateToken SourceTypeformAuthorizationMethodType = "source-typeform_Private Token"
)

type SourceTypeformAuthorizationMethod struct {
	SourceTypeformOAuth20      *SourceTypeformOAuth20      `queryParam:"inline" union:"member"`
	SourceTypeformPrivateToken *SourceTypeformPrivateToken `queryParam:"inline" union:"member"`

	Type SourceTypeformAuthorizationMethodType
}

func CreateSourceTypeformAuthorizationMethodSourceTypeformOAuth20(sourceTypeformOAuth20 SourceTypeformOAuth20) SourceTypeformAuthorizationMethod {
	typ := SourceTypeformAuthorizationMethodTypeSourceTypeformOAuth20

	return SourceTypeformAuthorizationMethod{
		SourceTypeformOAuth20: &sourceTypeformOAuth20,
		Type:                  typ,
	}
}

func CreateSourceTypeformAuthorizationMethodSourceTypeformPrivateToken(sourceTypeformPrivateToken SourceTypeformPrivateToken) SourceTypeformAuthorizationMethod {
	typ := SourceTypeformAuthorizationMethodTypeSourceTypeformPrivateToken

	return SourceTypeformAuthorizationMethod{
		SourceTypeformPrivateToken: &sourceTypeformPrivateToken,
		Type:                       typ,
	}
}

func (u *SourceTypeformAuthorizationMethod) UnmarshalJSON(data []byte) error {

	var candidates []utils.UnionCandidate

	// Collect all valid candidates
	var sourceTypeformOAuth20 SourceTypeformOAuth20 = SourceTypeformOAuth20{}
	if err := utils.UnmarshalJSON(data, &sourceTypeformOAuth20, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  SourceTypeformAuthorizationMethodTypeSourceTypeformOAuth20,
			Value: &sourceTypeformOAuth20,
		})
	}

	var sourceTypeformPrivateToken SourceTypeformPrivateToken = SourceTypeformPrivateToken{}
	if err := utils.UnmarshalJSON(data, &sourceTypeformPrivateToken, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  SourceTypeformAuthorizationMethodTypeSourceTypeformPrivateToken,
			Value: &sourceTypeformPrivateToken,
		})
	}

	if len(candidates) == 0 {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SourceTypeformAuthorizationMethod", string(data))
	}

	// Pick the best candidate using multi-stage filtering
	best := utils.PickBestUnionCandidate(candidates, data)
	if best == nil {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SourceTypeformAuthorizationMethod", string(data))
	}

	// Set the union type and value based on the best candidate
	u.Type = best.Type.(SourceTypeformAuthorizationMethodType)
	switch best.Type {
	case SourceTypeformAuthorizationMethodTypeSourceTypeformOAuth20:
		u.SourceTypeformOAuth20 = best.Value.(*SourceTypeformOAuth20)
		return nil
	case SourceTypeformAuthorizationMethodTypeSourceTypeformPrivateToken:
		u.SourceTypeformPrivateToken = best.Value.(*SourceTypeformPrivateToken)
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for SourceTypeformAuthorizationMethod", string(data))
}

func (u SourceTypeformAuthorizationMethod) MarshalJSON() ([]byte, error) {
	if u.SourceTypeformOAuth20 != nil {
		return utils.MarshalJSON(u.SourceTypeformOAuth20, "", true)
	}

	if u.SourceTypeformPrivateToken != nil {
		return utils.MarshalJSON(u.SourceTypeformPrivateToken, "", true)
	}

	return nil, errors.New("could not marshal union type SourceTypeformAuthorizationMethod: all fields are null")
}

type SourceTypeformSourceType string

const (
	SourceTypeformSourceTypeTypeform SourceTypeformSourceType = "typeform"
)

func (e SourceTypeformSourceType) ToPointer() *SourceTypeformSourceType {
	return &e
}
func (e *SourceTypeformSourceType) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "typeform":
		*e = SourceTypeformSourceType(v)
		return nil
	default:
		return fmt.Errorf("invalid value for SourceTypeformSourceType: %v", v)
	}
}

type SourceTypeform struct {
	Credentials SourceTypeformAuthorizationMethod `json:"credentials"`
	// When this parameter is set, the connector will replicate data only from the input forms. Otherwise, all forms in your Typeform account will be replicated. You can find form IDs in your form URLs. For example, in the URL "https://mysite.typeform.com/to/u6nXL7" the form_id is u6nXL7. You can find form URLs on Share panel
	FormIds []string `json:"form_ids,omitempty"`
	// The date from which you'd like to replicate data for Typeform API, in the format YYYY-MM-DDT00:00:00Z. All data generated after this date will be replicated.
	StartDate            *time.Time                `json:"start_date,omitempty"`
	sourceType           *SourceTypeformSourceType `const:"typeform" json:"sourceType"`
	AdditionalProperties any                       `additionalProperties:"true" json:"-"`
}

func (s SourceTypeform) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(s, "", false)
}

func (s *SourceTypeform) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &s, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (s *SourceTypeform) GetCredentials() SourceTypeformAuthorizationMethod {
	if s == nil {
		return SourceTypeformAuthorizationMethod{}
	}
	return s.Credentials
}

func (s *SourceTypeform) GetFormIds() []string {
	if s == nil {
		return nil
	}
	return s.FormIds
}

func (s *SourceTypeform) GetStartDate() *time.Time {
	if s == nil {
		return nil
	}
	return s.StartDate
}

func (s *SourceTypeform) GetSourceType() *SourceTypeformSourceType {
	return SourceTypeformSourceTypeTypeform.ToPointer()
}

func (s *SourceTypeform) GetAdditionalProperties() any {
	if s == nil {
		return nil
	}
	return s.AdditionalProperties
}
