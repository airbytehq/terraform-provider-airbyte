// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package int32planmodifier

import (
	"context"

	"github.com/hashicorp/terraform-plugin-framework/resource/schema/planmodifier"
	"github.com/hashicorp/terraform-plugin-framework/types"
)

// UseConfigValue returns a plan modifier that ensures the configuration value
// is always used for plan-only attributes, preventing Terraform core from
// copying prior state into the plan when configuration is null.
func UseConfigValue() planmodifier.Int32 {
	return useConfigValue{}
}

type useConfigValue struct{}

func (m useConfigValue) Description(_ context.Context) string {
	return "Uses the configuration value for this attribute, ensuring prior state " +
		"is not automatically copied into the plan when configuration is null."
}

func (m useConfigValue) MarkdownDescription(_ context.Context) string {
	return "Uses the configuration value for this attribute, ensuring prior state " +
		"is not automatically copied into the plan when configuration is null."
}

func (m useConfigValue) PlanModifyInt32(ctx context.Context, req planmodifier.Int32Request, resp *planmodifier.Int32Response) {
	// If configuration is unknown, don't modify
	if req.ConfigValue.IsUnknown() {
		return
	}

	// If configuration is explicitly set (not null), always use it
	if !req.ConfigValue.IsNull() {
		resp.PlanValue = req.ConfigValue
		return
	}

	// Configuration is null - check if we should override the plan
	// At this point, the plan value could be:
	// 1. A default value (if one was defined) - we want to keep this
	// 2. The state value (if Terraform copied it) - we want to override with null
	// 3. Unknown (for new computed fields) - we want to keep this
	// 4. Null - already correct

	if req.PlanValue.IsNull() || req.PlanValue.IsUnknown() {
		return
	}

	// Plan has a value and config is null
	// If plan equals state, Terraform copied state into plan - override with null
	// If plan differs from state, a default was likely applied - keep it
	if !req.StateValue.IsNull() && req.PlanValue.Equal(req.StateValue) {
		resp.PlanValue = types.Int32Null()
	}
}
